{"ts":1351335843599,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"/* modified version of http://gamedev.stackexchange.com/a/1436 */\r\n/**\r\n  A simple animation object.\r\n*/\r\nfunction AnimationData(frames, options) {\r\n  this.frames = frames || [{ x: 0, y: 0, w: 0, h: 0, length: 0 }];\r\n  this.options = options || {\r\n    repeats: false,\r\n    keyframe: 0\r\n  };\r\n}\r\n\r\n/**\r\n  Each object would have one of these to play any animation back.\r\n*/\r\nfunction SpriteManager(animation) {\r\n  var ani = animation || new AnimationData();\r\n  this.defaultAnim = new AnimationData(Game.spriteDB.base['Happy_FORWARD'],\r\n\t\t{\r\n\t\t  repeats: true,\r\n\t\t  keyframe: 0\r\n\t\t}\r\n\t);\t\r\n\r\n  this.length = 0;\r\n  this.frame = undefined;\r\n  this.index = 0;\r\n  this.elapsed = 0;\r\n\r\n  this.setAnimation(ani);\r\n  this.reset();\r\n}\r\nSpriteManager.prototype.SetCurrentAnimation = function(animation)\r\n{\r\n\tthis.setAnimation(animation);\r\n};\r\n\r\nSpriteManager.prototype.reset = function() {\r\n  this.elapsed = 0;\r\n  this.index = 0;\r\n  this.frame = this.animation.frames[this.index];\r\n};\r\n\r\nSpriteManager.prototype.update = function(dt) {\r\n  this.elapsed = this.elapsed + dt;\r\n\r\n  if(this.elapsed >= this.frame.length) {\r\n    this.index++;\r\n    this.elapsed = this.elapsed - this.frame.length;\r\n  }\r\n  this.frame = this.animation.frames[this.index];\r\n  if(this.index >= this.length) {\r\n    if(this.animation.options.repeats) {\r\n      this.index = this.animation.options.keyframe;\r\n\t\tthis.frame = this.animation.frames[this.index];\r\n    } else {\r\n\t  this.setAnimation(this.defaultAnim);\r\n\t  this.index = 0;\r\n\t   this.frame = this.defaultAnim.frames[0];\r\n\t  //this.index--;\r\n\t//\tthis.reset();\r\n\t}\r\n  }\r\n\r\n\r\n};\r\n\r\nSpriteManager.prototype.setAnimation = function(animation, reset) {\r\n  this.animation = animation;\r\n  this.length = this.animation.frames.length;\r\n};\r\n\r\n "]],"start1":0,"start2":0,"length1":0,"length2":1750}]],"length":1750}
